<UserControl x:Class="NetworkService.Views.EntitiesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NetworkService.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

    <Grid Background="#F0F0F0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <!-- LEVI DEO: Search/filter -->
        <StackPanel Margin="10" Grid.Column="0">
            <TextBlock Text="Entity Search" FontWeight="Bold" Margin="0,5"/>

            <StackPanel>
                <RadioButton Content="Name" IsChecked="{Binding SearchByName}" GroupName="SearchOption"/>
                <RadioButton Content="Type" IsChecked="{Binding SearchByType}" GroupName="SearchOption"/>
            </StackPanel>

            <TextBox Width="150" Margin="0,5"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>

            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                <Button Content="Apply" Command="{Binding ApplySearchCommand}" Margin="0,0,5,0"/>
                <Button Content="Clear" Command="{Binding ClearSearchCommand}"/>
            </StackPanel>
        </StackPanel>

        <!-- DESNI DEO: Add + Tabela -->
        <StackPanel Grid.Column="1" Margin="10">
            <TextBlock Text="Add new entity:" FontWeight="Bold" Margin="0,5"/>
            
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- ID -->
                <StackPanel Grid.Row="0" Grid.Column="0" Margin="5">
                    <TextBox Text="{Binding CurrentEntity.Id, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Foreground="Red" FontSize="12"
                               Text="{Binding CurrentEntity.ValidationErrors[Id]}"/>
                </StackPanel>

                <!-- Name -->
                <StackPanel Grid.Row="0" Grid.Column="1" Margin="5">
                    <TextBox Text="{Binding CurrentEntity.Name, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Foreground="Red" FontSize="12"
                               Text="{Binding CurrentEntity.ValidationErrors[Name]}"/>
                </StackPanel>

                <!-- Type -->
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="5">
                    <ComboBox ItemsSource="{Binding AvailableTypes}"
                              SelectedItem="{Binding CurrentEntity.Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                              DisplayMemberPath="Name"/>
                    <TextBlock Foreground="Red" FontSize="12"
                               Text="{Binding CurrentEntity.ValidationErrors[Type]}"/>
                </StackPanel>

                <!-- Value -->
                <StackPanel Grid.Row="1" Grid.Column="1" Margin="5">
                    <TextBox Text="{Binding CurrentEntity.Value, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBlock Foreground="Red" FontSize="12"
                               Text="{Binding CurrentEntity.ValidationErrors[Value]}"/>
                </StackPanel>
            </Grid>

            <!-- Add button -->
            <Button Content="Add" Command="{Binding AddCommand}" 
                    Width="100" Margin="5" HorizontalAlignment="Left"/>

            <!-- Tabela -->
            <DataGrid ItemsSource="{Binding FilteredEntities}"
                      SelectedItem="{Binding SelectedEntity}"
                      AutoGenerateColumns="False" 
                      Margin="0,10,0,0"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      IsReadOnly="True"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      ColumnWidth="*">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id}"/>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name}"/>
                    <DataGridTextColumn Header="Type" Binding="{Binding Type}"/>
                    <DataGridTextColumn Header="Value" Binding="{Binding Value}"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Delete button -->
            <Button Content="Delete Selected" 
                    Command="{Binding DeleteCommand}" 
                    Margin="0,5"/>
        </StackPanel>
    </Grid>
</UserControl>